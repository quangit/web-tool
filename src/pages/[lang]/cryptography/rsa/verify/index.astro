---
import BasePage from '../../../../../components/BasePage.astro';
import BaseSettingBlock from '../../../../../components/BaseSettingBlock.astro';
import CopyButton from '../../../../../components/CopyButton.astro';
import { languages } from '../../../../../i18n/ui';
import { useTranslations } from '../../../../../i18n/utils';

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => {
    return { params: { lang } };
  });
}

const { lang = 'en' } = Astro.params;
const t = useTranslations(lang as any);

const title = t('rsa_verify.title');
const description = t('rsa_verify.description');
const activePage = 'cryptography/rsa/verify';
---

<BasePage title={title} description={description} activePage={activePage}>
  <div class="layout">
    <div class="layout-block">
      <div class="input">
        <div class="block block-fill">
          <div class="block-title">
            {t('input')}
            <div class="toolbar">
              <button class="icon" data-toggle="fullscreen"
                ><i class="fullscreen-icon" data-lucide="maximize" title="Full Screen"></i><i
                  class="fullscreen-icon-exit"
                  data-lucide="minimize"
                  title="Full Screen"></i></button
              >
            </div>
          </div>
          <textarea
            class="container"
            id="input"
            spellcheck="false"
            placeholder={t('enter_here')}
            data-remember="input"
            data-share="input"
            data-encoding-from="#input-type"
            data-auto-update
            data-toggle="monacoEditor"></textarea>
        </div>
      </div>
      <div class="output">
        <div class="block block-fill">
          <div class="block-title">
            {t('output')}
            <div class="toolbar">
              <button class="icon" data-toggle="fullscreen"
                ><i class="fullscreen-icon" data-lucide="maximize" title="Full Screen"></i><i
                  class="fullscreen-icon-exit"
                  data-lucide="minimize"
                  title="Full Screen"></i></button
              >
            </div>
          </div>
          <div class="container" id="validate-result"></div>
          <textarea
            class="container"
            id="output"
            spellcheck="false"
            placeholder={t('error_message')}
            data-encoding-from="#output-type"
            readonly="readonly"></textarea>
        </div>
        <details class="block text-only" data-toggle="copyblock">
          <summary class="block-title"
            >{t('share_link')}<div class="toolbar">
              <CopyButton target="#share-link" message={t('share_link_copied')} />
            </div></summary
          >
          <input id="share-link" type="text" placeholder={t('share_link')} readonly="readonly" />
        </details>
      </div>
    </div>
    <BaseSettingBlock title={t('settings')}>
      <div class="setting"><a class="btn" id="execute">{t('verify')}</a></div>
      <div class="setting">
        <label class="switcher"
          ><input type="checkbox" value="1" id="auto-update" checked /><div class="toggle"></div>
          <span>{t('auto_update')}</span></label
        >
      </div>
      <div class="setting">
        <label class="switcher"
          ><input type="checkbox" value="1" id="remember-input" /><div class="toggle"></div>
          <span>{t('remember_input')}</span></label
        >
      </div>
      <div class="setting">
        <label for="input-type">{t('input_encoding')}</label><select
          data-toggle="encoding"
          id="input-type"
          data-remember="input-type"
          data-share="input_type"
          data-auto-update
        >
          <optgroup label="Binary">
            <option value="hex">Hex</option>
            <option value="base64" data-load-encoding="base64">Base64</option>
          </optgroup>
          <optgroup label="Text">
            <option value="utf-8" selected>UTF-8</option>
            <option value="utf-16le" data-load-encoding="1">UTF-16LE</option>
            <option value="utf-16be" data-load-encoding="1">UTF-16BE</option>
          </optgroup>
        </select>
      </div>
      <div class="setting">
        <label for="algorithm">{t('algorithm')}</label><select
          id="algorithm"
          data-option="algorithm"
          data-remember="algorithm"
          data-share="algorithm"
        >
          <option value="MD5">MD5</option>
          <option value="SHA1">SHA1</option>
          <option value="SHA224">SHA224</option>
          <option value="SHA256" selected>SHA256</option>
          <option value="SHA384">SHA384</option>
          <option value="SHA512">SHA512</option>
          <option value="RIPEMD160">RIPEMD160</option>
        </select>
      </div>
      <div class="setting">
        <label for="public-key">{t('public_key')}</label><textarea
          id="public-key"
          placeholder={t('public_key')}
          data-option="public-key"
          data-remember="public-key"
          data-share="public_key"></textarea>
      </div>
      <details class="setting-group" open>
        <summary>{t('signature')}</summary>
        <div class="setting">
          <label for="signature-input-type">{t('type')}</label><select
            id="signature-input-type"
            data-option="signature-input-type"
            data-remember="signature-input-type"
            data-share="signature_input_type"
            data-toggle="key-type"
            data-target="#passphrase-block"
          >
            <option value="hex">Hex</option>
            <option value="base64">Base64</option>
          </select>
        </div>
        <div class="setting">
          <label for="signature">{t('data')}</label><textarea
            id="signature"
            placeholder={t('signature')}
            data-option="signature"
            data-remember="signature"
            data-share="signature"></textarea>
        </div>
      </details>
    </BaseSettingBlock>
  </div>
</BasePage>

<script is:inline>
  ++waitLoadCount;
  delayScripts.push({
    src: '/js/jsrsasign.js?v=1',
    onload: function () {
      window.method = withOptions(rsa.verify, [
        'public-key',
        'algorithm',
        'signature-input-type',
        'signature',
      ]);
      methodLoad();
    },
  });
</script>
<script is:inline>
  ++waitLoadCount;
  delayScripts.push({
    src: '/js/jsrsasign-all-min.min.js',
    onload: function () {
      methodLoad();
    },
  });
</script>
<script is:inline>
  ++waitLoadCount;
  delayScripts.push({
    src: '/js/encoding.js?v=8',
    onload: function () {
      methodLoad();
    },
  });
</script>

<script is:inline>
  ++waitLoadCount;
  delayScripts.push({
    src: '/js/validator.js',
    onload: function () {
      methodLoad();
    },
  });
</script>
