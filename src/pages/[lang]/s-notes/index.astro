---
import BasePage from '../../../components/BasePage.astro';
import { languages } from '../../../i18n/ui';
import { useTranslations } from '../../../i18n/utils';

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
const t = useTranslations(lang as any);
---

<BasePage title={t('s_notes.title')} description={t('s_notes.description')} activePage="s-notes">
  <div class="layout">
    <div class="layout-block">
      <div class="input">
        <div class="block block-fill">
          <div class="notes-content-wrapper">
            <div id="note-editor" class="note-editor">
              <div id="editor-container"></div>
            </div>
            <div id="empty-state" class="empty-state">
              <p>{t('s_notes.no_notes')}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="settings">
      <div class="block block-fill">
        <div class="block-title">
          <span>{t('s_notes.category')}</span>
          <button id="new-note-btn" class="btn">{t('s_notes.new_note')}</button>
        </div>
        <div class="container">
          <div class="notes-sidebar-wrapper">
            <div class="notes-header">
              <div class="setting">
                <input
                  type="text"
                  id="search-notes"
                  class="search-input"
                  placeholder={t('s_notes.search_notes')}
                />
              </div>
              <div class="notes-tabs">
                <button class="notes-tab active" data-tab="all" id="tab-all"
                  >{t('s_notes.tab_all') || 'All'}</button
                >
                <button class="notes-tab" data-tab="favorites" id="tab-favorites">
                  <span class="tab-star">‚≠ê</span>
                  {t('s_notes.tab_favorites') || 'Favorites'}
                </button>
              </div>
              <div class="setting storage-info">
                <span id="storage-status" class="storage-status">
                  <span class="status-dot"></span>
                  <span class="status-text">{t('s_notes.loading')}</span>
                </span>
              </div>
            </div>
            <div id="notes-list" class="notes-list">
              <!-- Notes will be dynamically inserted here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script
    is:inline
    set:html={`
    window.notesTranslations = {
      untitled: ${JSON.stringify(t('s_notes.untitled'))},
      category: ${JSON.stringify(t('s_notes.category'))},
      confirmDelete: ${JSON.stringify(t('s_notes.confirm_delete'))},
      confirmDeleteWithChildren: ${JSON.stringify(t('s_notes.confirm_delete_with_children') || 'This note has child notes. Delete this note and all its children?')},
      delete: ${JSON.stringify(t('s_notes.delete'))},
      createChild: ${JSON.stringify(t('s_notes.create_child') || 'Create Note Item')},
      addToFavorites: ${JSON.stringify(t('s_notes.add_to_favorites') || 'Add to Favorites')},
      removeFromFavorites: ${JSON.stringify(t('s_notes.remove_from_favorites') || 'Remove from Favorites')},
      noNotes: ${JSON.stringify(t('s_notes.no_notes'))},
      noFavorites: ${JSON.stringify(t('s_notes.no_favorites') || 'No favorite notes yet')},
      loading: ${JSON.stringify(t('s_notes.loading') || 'Loading...')},
      ready: ${JSON.stringify(t('s_notes.ready') || 'Ready')},
      syncing: ${JSON.stringify(t('s_notes.syncing') || 'Syncing...')},
      error: ${JSON.stringify(t('s_notes.error') || 'Error')},
      attachments: ${JSON.stringify(t('s_notes.attachments') || 'Attachments')},
      deleteAttachment: ${JSON.stringify(t('s_notes.delete_attachment') || 'Delete attachment?')},
      openInNewWindow: ${JSON.stringify(t('s_notes.detach') || 'Open in new window')}
    };
  `}
  />

  <script is:inline>
    ++waitLoadCount;
  </script>
  <script>
    import '../../../styles/s-notes.css';
    import '../../../scripts/s-notes.js';
  </script>
</BasePage>
